package org.apache.pdfbox;

import java.io.File;  
import java.io.InputStream;
import java.io.FileOutputStream;  
import java.io.OutputStreamWriter;  
import java.io.Reader;
import java.io.FileReader;
import java.io.Writer;  
import java.io.BufferedReader;
import java.net.MalformedURLException;  
import java.net.URL;  
  

import org.apache.pdfbox.pdmodel.*;
import org.apache.pdfbox.util.*; 

public class pdfExtraction{
	public static final String default_encoding = "UTF-8";
	public void getText(String filename) throws Exception
	{
		String start = "references";
		String end = "";
		boolean sort = false;
		File file = null;
		File outputFile = null;
		FileReader reader = null;
		BufferedReader pdfFile = null;
		String pdfWriteFile = filename;
		PDFTextStripper stripper = null;
		PDDocument document = null;
		String textFile = null;
		String encoding = "UTF-8";
		Writer output = null;
		String line =null;
		int StartPage = 3;
		int EndPage = Integer.MAX_VALUE;
		
		//read the file using PDDocument Class
		document = PDDocument.load(pdfWriteFile);
		if(filename.length()>4)	//substitute the extension of the file from .pdf to .txt using the same filename
		{
			outputFile = new File(filename.substring(0, filename.length()-4)+".txt");
			textFile = outputFile.getName();
		}		
		else
			System.out.println("Wrong filename format");
		
		//read the file using BufferedReader Class
		file = new File(filename);
		reader = new FileReader(file);
		pdfFile = new BufferedReader(reader);
		/*while((line = pdfFile.readLine()) != null)
		{
			if(line =="references")
				System.out.println("aa");
		}*/

		
		output = new OutputStreamWriter(new FileOutputStream(textFile), encoding);
		stripper = new PDFTextStripper();
		stripper.setSortByPosition(sort);
		//stripper.setArticleStart(start);
		//stripper.setArticleEnd(end);
		stripper.setStartPage(StartPage);
		stripper.setEndPage(EndPage);
		stripper.writeText(document, output);		
	}
	
	public static void main(String[]args)
	{
		pdfExtraction content = new pdfExtraction();
		try{
			content.getText("abcdef.pdf");
		}
		catch (Exception e) {  
            e.printStackTrace(); 
            }
	}
}